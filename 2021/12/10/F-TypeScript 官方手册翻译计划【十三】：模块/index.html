<!-- build time:Fri Dec 10 2021 20:28:05 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/prism.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><section class="posts"><article class="post_full"><h1 class="post-title"><div class="post-title-link">TypeScript 官方手册翻译计划【十三】：模块</div></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2021-12-10&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp2.7k&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp11 mins&nbsp&nbsp&nbsp</span><div class="post-tags"><i class="fa fa-tags"></i> <a href="/tags/TypeScript/">TypeScript</a> <a href="/tags/documentation/">documentation</a></div></div><div class="post-content"><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/TypeScript%20%E5%AE%98%E6%96%B9%E6%89%8B%E5%86%8C%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92/banner.jpeg" alt=""></p><span id="more"></span><blockquote><ul><li><strong>说明</strong>：目前网上没有 TypeScript 最新官方文档的中文翻译，所以有了这么一个翻译计划。因为我也是 TypeScript 的初学者，所以无法保证翻译百分之百准确，若有错误，欢迎评论区指出；</li><li><strong>翻译内容</strong>：暂定翻译内容为 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/intro.html">TypeScript Handbook</a>，后续有空会补充翻译文档的其它部分；</li><li><strong>项目地址</strong>：<a target="_blank" rel="noopener" href="https://github.com/Chorer/TypeScript-Doc-Zh">TypeScript-Doc-Zh</a>，如果对你有帮助，可以点一个 star ~</li></ul></blockquote><p>本章节官方文档地址：<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/2/modules.html">Modules</a></p><h2 id="模块"><a class="markdownIt-Anchor" href="#模块"></a> 模块</h2><p>处理模块化代码的方式很多，JavaScript 在这方面有着悠久的历史。TypeScript 诞生于 2012 年，对许多模块化方案也实现了支持。但随着时间的推移，社区和 JavaScript 规范在一种名为 ES 模块（或者称为 ES6 模块）的方案上达成了共识。你可能听说过它的 <code>import/export</code> 语法。</p><p>ES 模块于 2015 年被纳入 JavaScript 规范，到了 2020 年，它已经获得了多数 web 浏览器和 JavaScript 运行时的支持。</p><p>本手册会重点讲解 ES 模块以及在它之前非常流行的、提供了 <code>module.exports =</code> 语法的 CommonJS。在“参考”章节的<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/modules.html">模块</a>这一小节中，你可以了解到更多关于其它模块化方案的信息。</p><h3 id="javascript-的模块是如何定义的"><a class="markdownIt-Anchor" href="#javascript-的模块是如何定义的"></a> JavaScript 的模块是如何定义的</h3><p>和 ECMAScript 2015 一样，TypeScript 会将任何包含顶层 <code>import</code> 或者 <code>export</code> 的文件视为一个模块。</p><p>反过来，一个不包含顶层 <code>import</code> 或者 <code>export</code> 声明的文件会被视为一个脚本，它的内容可以在全局作用域中访问到（因此对模块也是可见的）。</p><p>模块在自身的作用域而非全局作用域中执行。这意味着在一个模块中声明的变量、函数和类等在模块外面是不可见的，除非使用其中一种导出方式将它们显式导出。反过来，为了使用从某个不同的模块中导出的变量、函数、类等，也需要使用其中一种导入方式将它们导入。</p><h3 id="非模块"><a class="markdownIt-Anchor" href="#非模块"></a> 非模块</h3><p>在我们开始之前，有个很重要的事情需要搞清楚，那就是 TypeScript 会将什么视为一个模块。JavaScript 规范表明，任何不包含 <code>export</code> 或者顶层 <code>await</code> 的 JavaScript 文件都应该被视为一个脚本，而不是一个模块。</p><p>在一个脚本文件中声明的变量和类型会位于共享的全局作用域中，而且通常情况下，你会使用 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#outFile">outFile</a> 编译选项将多个输入文件合并为一个输出文件，或者使用 HTML 文件中的多个 <code>&lt;script&gt;</code> 标签去（以正确的顺序！）加载文件。</p><p>如果你的文件当前没有任何的 <code>import</code> 或者 <code>export</code>，但是你想将其视为一个模块，那么可以添加下面这行代码：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">export</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这会将文件转化为没有导出任何东西的一个模块。不管你的模块目标是什么，这个语法都可以生效。</p><h3 id="typescript-中的模块"><a class="markdownIt-Anchor" href="#typescript-中的模块"></a> TypeScript 中的模块</h3><p>在 TypeScript 中编写基于模块的代码时，有三件主要的事情需要考虑：</p><ul><li>**语法：**我想要使用什么语法去进行导入和导出？</li><li>**模块解析：**模块名（或者路径）和磁盘上的文件有什么关系？</li><li>**模块输出目标：**产生的 JavaScript 模块看起来应该是什么样子的？</li></ul><h4 id="es-模块语法"><a class="markdownIt-Anchor" href="#es-模块语法"></a> ES 模块语法</h4><p>一个文件可以通过 <code>export default</code> 声明一个主要的导出：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: hello.ts
export default function helloWorld() &#123;
  console.log(&quot;Hello, world!&quot;);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>接着通过下面的语句导入：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import hello from &quot;.&#x2F;hello.js&quot;;
hello();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>除了默认导出之外，你还可以省略 <code>default</code>，直接用 <code>export</code> 导出多个变量和函数：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// @filename: maths.ts</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> pi <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> squareTwo <span class="token operator">=</span> <span class="token number">1.41</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> phi <span class="token operator">=</span> <span class="token number">1.61</span><span class="token punctuation">;</span>
 
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">RandomNumberGenerator</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
 
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">absolute</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> num<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>你可以通过 <code>import</code> 语法在另一个文件中导入：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> pi<span class="token punctuation">,</span> phi<span class="token punctuation">,</span> absolute <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./maths.js"</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> absPhi <span class="token operator">=</span> <span class="token function">absolute</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token operator">^</span>
   <span class="token comment">// const absPhi: number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="其它导入语法"><a class="markdownIt-Anchor" href="#其它导入语法"></a> 其它导入语法</h4><p>可以使用诸如 <code>import &#123;old as new&#125;</code> 这样的形式重新命名一个导入：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> pi <span class="token keyword">as</span> π <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./maths.js"</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>π<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">^</span>
     <span class="token comment">//(alias) var π: number</span>
    <span class="token comment">// import π</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>你可以将上述语法混合为单个 <code>import</code>：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// @filename: maths.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> pi <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">RandomNumberGenerator</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
 
<span class="token comment">// @filename: app.ts</span>
<span class="token keyword">import</span> RNGen<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> pi <span class="token keyword">as</span> π <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./maths.js"</span><span class="token punctuation">;</span>
 
RNGen<span class="token punctuation">;</span>
  <span class="token operator">^</span>
<span class="token comment">//(alias) class RNGen</span>
<span class="token comment">//import RNGen</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>π<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">^</span>
     <span class="token comment">// (alias) const π: 3.14</span>
    <span class="token comment">// import π</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用 <code>* as name</code>，你可以接受所有导出对象，并将它们放入单个命名空间中：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// @filename: app.ts</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> math <span class="token keyword">from</span> <span class="token string">"./maths.js"</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> positivePhi <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">absolute</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token operator">^</span>
    <span class="token comment">// const positivePhi: number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用 <code>import &quot;./file&quot;</code>，你可以在当前模块中仅导入文件，而不导入文件中的任何变量：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// @filename: app.ts</span>
<span class="token keyword">import</span> <span class="token string">"./maths.js"</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"3.14"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在这种情况下，<code>import</code> 不会做任何事。不过，<code>math.ts</code> 中的所有代码都会被执行，这可能会触发副作用并影响其它对象。</p><h5 id="typescript-专属的-es-模块语法"><a class="markdownIt-Anchor" href="#typescript-专属的-es-模块语法"></a> TypeScript 专属的 ES 模块语法</h5><p>你可以使用和 JavaScript 值一样的语法将类型进行导出和导入：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: animal.ts
export type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;
 
export interface Dog &#123;
  breeds: string[];
  yearOfBirth: number;
&#125;
 
&#x2F;&#x2F; @filename: app.ts
import &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;
type Animals &#x3D; Cat | Dog;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>TypeScript 为 <code>import</code> 语法拓展了两个用途，让它可以声明类型导入：</p><p><strong><code>import type</code></strong></p><p>该导入语句只能导入类型：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: animal.ts
export type Cat &#x3D; &#123; breed: string; yearOfBirth: number &#125;;
&#x2F;&#x2F; &#39;createCatName&#39; cannot be used as a value because it was imported using &#39;import type&#39;.
export type Dog &#x3D; &#123; breeds: string[]; yearOfBirth: number &#125;;
export const createCatName &#x3D; () &#x3D;&gt; &quot;fluffy&quot;;
 
&#x2F;&#x2F; @filename: valid.ts
import type &#123; Cat, Dog &#125; from &quot;.&#x2F;animal.js&quot;;
export type Animals &#x3D; Cat | Dog;
 
&#x2F;&#x2F; @filename: app.ts
import type &#123; createCatName &#125; from &quot;.&#x2F;animal.js&quot;;
const name &#x3D; createCatName();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>内联 <code>type</code> 导入</strong></p><p>TypeScript 4.5 也允许单个导入使用 <code>type</code> 前缀表明导入的引用是一个类型：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">&#x2F;&#x2F; @filename: app.ts
import &#123; createCatName, type Cat, type Dog &#125; from &quot;.&#x2F;animal.js&quot;;
 
export type Animals &#x3D; Cat | Dog;
const name &#x3D; createCatName();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>所有这些都允许诸如 Babel、swc 或者 esbuild 这样的非 TypeScript 转译工具知道哪些导入是可以被安全地移除的。</p><h5 id="具备-commonjs-行为的-es-模块语法"><a class="markdownIt-Anchor" href="#具备-commonjs-行为的-es-模块语法"></a> 具备 CommonJS 行为的 ES 模块语法</h5><p>TypeScript 的 ES 模块语法可以和 CommonJS 与 AMD 的 <code>require</code> 直接关联。在大多数情况下，使用 ES 模块的导入与相同环境下使用 <code>require</code> 是一样的，但这个语法可以确保你的 TypeScript 文件和 CommonJS 输出存在一对一的匹配：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import fs &#x3D; require(&quot;fs&quot;);
const code &#x3D; fs.readFileSync(&quot;hello.ts&quot;, &quot;utf8&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>你可以在<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/modules.html#export--and-import--require">模块</a>这一参考章节中了解到更多关于该语法的信息。</p><h3 id="commonjs-语法"><a class="markdownIt-Anchor" href="#commonjs-语法"></a> CommonJS 语法</h3><p>CommonJS 是大多数 npm 包采用的模块化方案。即使你编写代码的时候采用的是 ES 模块语法，简要了解一下 CommonJS 语法的工作方式也有助于简化你的调试过程。</p><h4 id="导出"><a class="markdownIt-Anchor" href="#导出"></a> 导出</h4><p>通过给一个名为 <code>module</code> 的全局对象设置 <code>exports</code> 属性，你可以导出标识符：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">function absolute(num: number) &#123;
  if (num &lt; 0) return num * -1;
  return num;
&#125;
 
module.exports &#x3D; &#123;
  pi: 3.14,
  squareTwo: 1.41,
  phi: 1.61,
  absolute,
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>之后可以通过 <code>require</code> 声明导入这些文件：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const maths &#x3D; require(&quot;maths&quot;);
maths.pi;
      ^
   &#x2F;&#x2F; any<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>或者你也可以使用 JavaScript 的解构语法只导入一部分内容：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">const &#123; squareTwo &#125; &#x3D; require(&quot;maths&quot;);
squareTwo;
    ^
  &#x2F;&#x2F; const squareTwo: any<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="commonjs-和-es-模块的互操作"><a class="markdownIt-Anchor" href="#commonjs-和-es-模块的互操作"></a> CommonJS 和 ES 模块的互操作</h4><p>由于默认导入和模块命名空间对象导入的差异，CommonJS 和 ES 模块在功能上存在不匹配的地方。TypeScript 提供了一个编译选项 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#esModuleInterop">esModuleInterop</a>，以减少这两组不同的约束之间的冲突。</p><h3 id="typescript-的模块解析选项"><a class="markdownIt-Anchor" href="#typescript-的模块解析选项"></a> TypeScript 的模块解析选项</h3><p>模块解析是一个过程，它指的是从 <code>import</code> 或者 <code>require</code> 声明中提取一个字符串，并确定该字符串所指示的文件。</p><p>TypeScript 使用两种解析策略：Classic 和 Node。使用 Classic 策略是为了实现向后兼容，当编译选项 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#module">module</a> 不是 <code>commonjs</code> 的时候，默认采用该策略。Node 策略则复刻了 Node.js 在 CommonJS 模式下的工作方式，并提供了额外的 <code>.ts</code> 和 <code>.d.ts</code> 检查。</p><p>还有很多 TSConfig 选项会影响到 TypeScript 中的模块策略，包括：<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#moduleResolution">moduleResolution</a>、<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#baseUrl">baseUrl</a>、<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#paths">paths</a>、<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#rootDirs">rootDirs</a>。</p><p>有关这些策略如何工作的详细信息，请阅读<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/module-resolution.html">模块解析</a>。</p><h3 id="typescript-的模块输出选项"><a class="markdownIt-Anchor" href="#typescript-的模块输出选项"></a> TypeScript 的模块输出选项</h3><p>有两个选项会影响到最终输出的 JavaScript：</p><ul><li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#target">target</a> 会决定哪些 JS 特性会被降级（进行转化并运行在比较旧的 JavaScript 运行时），哪些 JS 特性会被保留</li><li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#module">module</a> 会决定模块之间进行交互所使用的代码</li></ul><p>使用哪个 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#target">target</a>，取决于你希望执行 TypeScript 代码的 JavaScript 运行时可以使用的特性。这样的运行时可以是：你支持的最旧的浏览器，你希望可以运行的最低版本的 Node.js，或者从运行时 —— 比如 Electron 的唯一约束进行考量。</p><p>模块之间的所有通信通过一个模块加载器进行，编译选项 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#module">module</a> 会决定应该使用哪一个。在运行时，模块加载器负责在执行模块之前定位并执行模块的所有依赖。</p><p>举个例子，这是一个使用 ES 模块语法的 TypeScript 文件：</p><pre class="line-numbers language-ts" data-language="ts"><code class="language-ts">import &#123; valueOfPi &#125; from &quot;.&#x2F;constants.js&quot;;
 
export const twoPi &#x3D; valueOfPi * 2;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>下面是使用不同的 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#module">module</a> 选项之后的编译结果：</p><h5 id="es2020"><a class="markdownIt-Anchor" href="#es2020"></a> ES2020</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> valueOfPi <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./constants.js"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> twoPi <span class="token operator">=</span> valueOfPi <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="commonjs"><a class="markdownIt-Anchor" href="#commonjs"></a> CommonJS</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token string">"use strict"</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">"__esModule"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>twoPi <span class="token operator">=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> constants_js_1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./constants.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>twoPi <span class="token operator">=</span> constants_js_1<span class="token punctuation">.</span>valueOfPi <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="umd"><a class="markdownIt-Anchor" href="#umd"></a> UMD</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">factory</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">"object"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module<span class="token punctuation">.</span>exports <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">"function"</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"require"</span><span class="token punctuation">,</span> <span class="token string">"exports"</span><span class="token punctuation">,</span> <span class="token string">"./constants.js"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"use strict"</span><span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">"__esModule"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exports<span class="token punctuation">.</span>twoPi <span class="token operator">=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> constants_js_1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./constants.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exports<span class="token punctuation">.</span>twoPi <span class="token operator">=</span> constants_js_1<span class="token punctuation">.</span>valueOfPi <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>注意：ES2020 实际上和原先的 index.ts 是一样的。</p></blockquote><p>你可以在 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#module">TSConfig</a> 这一参考章节的“模块”小节中了解到所有可用的选项以及对应输出的 JavaScript 代码是怎么样的。</p><h3 id="typescript-命名空间"><a class="markdownIt-Anchor" href="#typescript-命名空间"></a> TypeScript 命名空间</h3><p>TypeScript 有自己的模块格式，名为“命名空间”，它比 ES 模块标准出现得要早。这个语法提供了很多有用的特性以创建复杂的定义文件，并且仍然广泛应用于 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/dt">DefinitelyTyped</a> 中。虽然该语法还没有被弃用，但鉴于 ES 模块已经拥有了命名空间的大部分特性，我们推荐你使用 ES 模块来跟 JavaScript 保持一致。在<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/namespaces.html">命名空间</a>的参考章节中，你可以了解到更多相关信息。</p></div><div class="post-nav"><div class="post-nav-prev"></div><div class="post-nav-next"><a href="/2021/12/09/F-TypeScript%20%E5%AE%98%E6%96%B9%E6%89%8B%E5%86%8C%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92%E3%80%90%E5%8D%81%E4%BA%8C%E3%80%91%EF%BC%9A%E7%B1%BB/" rel="next" title="TypeScript 官方手册翻译计划【十二】：类">TypeScript 官方手册翻译计划【十二】：类&nbsp<i class="fa fa-angle-double-right"></i></a></div><div class="clear"></div></div></article><div class="post-toc"><div class="toc-top">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97"><span class="toc-text">模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#javascript-%E7%9A%84%E6%A8%A1%E5%9D%97%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%E7%9A%84"><span class="toc-text">JavaScript 的模块是如何定义的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%A8%A1%E5%9D%97"><span class="toc-text">非模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typescript-%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="toc-text">TypeScript 中的模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#es-%E6%A8%A1%E5%9D%97%E8%AF%AD%E6%B3%95"><span class="toc-text">ES 模块语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%AF%BC%E5%85%A5%E8%AF%AD%E6%B3%95"><span class="toc-text">其它导入语法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#typescript-%E4%B8%93%E5%B1%9E%E7%9A%84-es-%E6%A8%A1%E5%9D%97%E8%AF%AD%E6%B3%95"><span class="toc-text">TypeScript 专属的 ES 模块语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B7%E5%A4%87-commonjs-%E8%A1%8C%E4%B8%BA%E7%9A%84-es-%E6%A8%A1%E5%9D%97%E8%AF%AD%E6%B3%95"><span class="toc-text">具备 CommonJS 行为的 ES 模块语法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#commonjs-%E8%AF%AD%E6%B3%95"><span class="toc-text">CommonJS 语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA"><span class="toc-text">导出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#commonjs-%E5%92%8C-es-%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BA%92%E6%93%8D%E4%BD%9C"><span class="toc-text">CommonJS 和 ES 模块的互操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typescript-%E7%9A%84%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90%E9%80%89%E9%A1%B9"><span class="toc-text">TypeScript 的模块解析选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typescript-%E7%9A%84%E6%A8%A1%E5%9D%97%E8%BE%93%E5%87%BA%E9%80%89%E9%A1%B9"><span class="toc-text">TypeScript 的模块输出选项</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#es2020"><span class="toc-text">ES2020</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#commonjs"><span class="toc-text">CommonJS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#umd"><span class="toc-text">UMD</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typescript-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-text">TypeScript 命名空间</span></a></li></ol></div><div id="vcomments"></div><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>function send_valine_Server(){var e="desp=",t=document.title,n=t.indexOf("|"),a=(t.substring(0,n),document.URL),s=new Date,l=document.getElementsByClassName("vnick vinput")[0].value||"Anonymous",i=(document.getElementsByClassName("vmail vinput")[0].value,document.getElementsByClassName("vlink vinput")[0].value,document.getElementsByClassName("veditor vinput")[0].value),o=e+"文章："+a+"\n\n昵称："+l+"\n\n留言："+i+"\n\n时间："+s.toLocaleString(),v=new XMLHttpRequest;v.open("POST","https://sc.ftqq.com/"+SCKEY_Server+".send",!0),v.setRequestHeader("Content-type","application/x-www-form-urlencoded"),v.send(title1+"&"+o)}new Valine({el:"#vcomments",appId:"c9Ume1Givsusy6VyqV87iT2z-gzGzoHsz",appKey:"5F7jhJfENet59xDteaKqobSK",notify:!1,verify:!1,placeholder:"Just talk here......",avatar:"retro",pageSize:10,visitor:!0});var title1="text=你的博客有新的评论",SCKEY_Server="SCT99005TwWJDrDKdBwQGK0YmcPRAsr4B",ValineButton=document.getElementsByClassName("vsubmit vbtn")[0];ValineButton.onclick=send_valine_Server</script></section></main><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2021</span> My Blog</p><p class="a">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue">PureBlue</a></p></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script><script src="/js/prism.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script src="/js/jquery.fancybox.js"></script><script src="/js/jquery.fancyboxStart.js"></script><script src="/js/toc.js"></script><script src="/js/jquery.toTop.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script><script src="/js/IndexToTop.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/tororo.model.json"},display:{position:"left",width:150,height:300,vOffset:-120,hOffset:-5},mobile:{show:!1},react:{opacityDefault:1e3,opacityOnHover:1e3},log:!1})</script></body></html><!-- rebuild by neat -->