<!-- build time:Sun Sep 05 2021 16:01:25 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><section class="posts"><article class="post_full"><h1 class="post-title"><div class="post-title-link">如何在Vue项目中更优雅地使用svg</div></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2020-04-29&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp1.4k&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp6 mins&nbsp&nbsp&nbsp</span><div class="post-tags"></div></div><div class="post-content"><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg-0.png"></div><span id="more"></span><p>最近看项目视频的时候对里面使用 svg 的方式感到很好奇，于是去网上查了一下，发现 svg 竟然也有类似于 css 雪碧图一样的用法，也就是 svg-sprite（孤陋寡闻了），而且配合插件后能够以组件化的方式使用 svg，非常方便。这里记录下一些相关用法。</p><p>视频里的做法是注册这样的一个全局组件：</p><div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html">// icon.vue
<span class="kw">&lt;svg&gt;</span>
    <span class="kw">&lt;defs&gt;</span>
        <span class="kw">&lt;symbol</span><span class="ot"> id=</span><span class="st">&quot;icon1&quot;</span><span class="kw">&gt;</span>
            <span class="kw">&lt;path&gt;&lt;/path&gt;</span>
        <span class="kw">&lt;/symbol&gt;</span>
        <span class="kw">&lt;symbol</span><span class="ot"> id=</span><span class="st">&quot;icon2&quot;</span><span class="kw">&gt;</span>
            <span class="kw">&lt;path&gt;&lt;/path&gt;</span>
        <span class="kw">&lt;/symbol&gt;</span>
        ......
    <span class="kw">&lt;/defs&gt;</span>
<span class="kw">&lt;/svg&gt;</span></code></pre></div><p>css 雪碧图中是把多个背景图片放在一张大的图片中，而 svg 雪碧图则是把多个 <code>symbol</code> 放在一个大的 svg 中，每个 <code>symbol</code> 代表了一个图标，以后每次想要使用图标，只需要写这么一段代码即可：</p><div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;svg&gt;</span>
    <span class="kw">&lt;use</span><span class="ot"> :xlink:href=</span><span class="st">&quot;#icon1&quot;</span><span class="kw">&gt;&lt;/use&gt;</span>
<span class="kw">&lt;/svg&gt;</span></code></pre></div><p>但是这里有两个问题：</p><ol style="list-style-type:decimal"><li>从图标库（比如阿里的 iconfont）下载下来的通常是 <code>.svg</code> 文件，如何根据多个单独的 <code>.svg</code> 文件生成 svg 雪碧图？</li><li>每次要使用图标都得写这么一段代码，并不是很方便，是否可以像使用组件那样使用图标？</li></ol><p>这里的关键是使用 <code>svg-sprite-loader</code> 这个插件。</p><h4 id="安装插件">安装插件</h4><p>首先 npm 安装：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript">npm install svg<span class="op">-</span>sprite<span class="op">-</span>loader <span class="op">--</span>save</code></pre></div><p>接着我们用一个文件夹专门放各种需要用到的 <code>.svg</code> 文件，这里以 <code>src/assets/img/icons</code> 为例，从 iconfont 下载 <code>.svg</code> 文件后放到这个文件夹即可。</p><h4 id="修改配置">修改配置</h4><p>vue-cli3 默认会通过 <code>file-loader</code> 对 <code>.svg</code> 文件进行处理，这里我们并不想让它处理我们的 <code>.svg</code> 图标文件，但是有的 <code>.svg</code> 文件又确确实实需要用它处理（总不可能所有的 svg 文件都用来做图标吧），所以我们要排除掉 <code>file-loader</code> 对 <code>src/assets/img/icons</code> 这个文件夹的处理。在 <code>vue.config,js</code> 的 <code>module.export</code> 中新增：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="va">module</span>.<span class="at">expors</span> <span class="op">=</span> <span class="op">&#123;</span>
  <span class="at">chainWebpack</span>(config)<span class="op">&#123;</span>
   <span class="co">//排除icons目录中svg文件处理</span>
    <span class="va">config</span>.<span class="va">module</span>.<span class="at">rule</span>(<span class="st">&#39;svg&#39;</span>)
   .<span class="va">exclude</span>.<span class="at">add</span>(<span class="at">resolve</span>(<span class="st">&#39;src/assets/img/icons&#39;</span>)
   .<span class="at">end</span>()
  <span class="op">&#125;</span>
<span class="op">&#125;</span></code></pre></div><p>接着，指定 <code>svg-sprite-loader</code> 对图标文件夹里面的 <code>.svg</code> 文件进行处理：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">const</span> path <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;path&#39;</span>)
<span class="kw">function</span> <span class="at">resolve</span>(dir)<span class="op">&#123;</span>
    <span class="cf">return</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span>dir)
<span class="op">&#125;</span>

<span class="va">module</span>.<span class="at">expors</span> <span class="op">=</span> <span class="op">&#123;</span>
  <span class="at">chainWebpack</span>(config)<span class="op">&#123;</span>
   <span class="co">//排除icons目录中svg文件处理</span>
    <span class="va">config</span>.<span class="va">module</span>.<span class="at">rule</span>(<span class="st">&#39;svg&#39;</span>)
   .<span class="va">exclude</span>.<span class="at">add</span>(<span class="at">resolve</span>(<span class="st">&#39;src/assets/img/icons&#39;</span>)
   .<span class="at">end</span>()
   <span class="co">//设置svg-sprite-loader处理icons目录中的svg</span>
    <span class="va">config</span>.<span class="at">module</span>
    .<span class="at">rule</span>(<span class="st">&#39;icons&#39;</span>)
    .<span class="at">test</span>(<span class="ss">/</span><span class="sc">\.</span><span class="ss">svg</span><span class="sc">$</span><span class="ss">/</span>)
    .<span class="va">include</span>.<span class="at">add</span>(<span class="at">resolve</span>(<span class="st">&#39;src/assets/img/icons&#39;</span>))
    .<span class="at">end</span>()
    .<span class="at">use</span>(<span class="st">&#39;svg-sprite-loader&#39;</span>)
    .<span class="at">loader</span>(<span class="st">&quot;svg-sprite-loader&quot;</span>)
    .<span class="at">options</span>(<span class="op">&#123;</span><span class="dt">symbolId</span><span class="op">:</span><span class="st">&#39;icon-[name]&#39;</span><span class="op">&#125;</span>)
    .<span class="at">end</span>()                
  <span class="op">&#125;</span>
<span class="op">&#125;</span></code></pre></div><p>这样其实已经可以生成 svg 雪碧图了，之后这个雪碧图会作为 <code>svg</code> 元素注入到 <code>html</code> 中：</p><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg-1.png"></div><p>接下来封装图标组件。</p><h4 id="封装图标组件">封装图标组件</h4><p>在 <code>components/common/icon</code> 下新建一个 <code>SvgIcon.vue</code> 文件：</p><div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;template&gt;</span>
  <span class="kw">&lt;svg</span><span class="ot"> :fill=</span><span class="st">&quot;iconColor&quot;</span><span class="ot"> class=</span><span class="st">&quot;svg-icon&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;use</span><span class="ot"> :xlink:href=</span><span class="st">&quot;iconNameCp&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/svg&gt;</span>
<span class="kw">&lt;/template&gt;</span>
<span class="kw">&lt;script&gt;</span>
<span class="im">export</span> <span class="im">default</span> <span class="op">&#123;</span>
  <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;svgIcon&#39;</span><span class="op">,</span>
  <span class="dt">props</span><span class="op">:</span> <span class="op">&#123;</span>
    <span class="co">// 图标类型</span>
    <span class="dt">iconName</span><span class="op">:</span> <span class="op">&#123;</span>
      <span class="dt">type</span><span class="op">:</span> String<span class="op">,</span>
      <span class="dt">required</span><span class="op">:</span> <span class="kw">true</span>
    <span class="op">&#125;,</span>
    <span class="co">// 图标颜色</span>
    <span class="dt">iconColor</span><span class="op">:&#123;</span>
      <span class="dt">type</span><span class="op">:</span>String<span class="op">,</span>
      <span class="dt">default</span><span class="op">:</span><span class="st">&#39;#666&#39;</span>
    <span class="op">&#125;</span>
  <span class="op">&#125;,</span>
  <span class="dt">computed</span><span class="op">:</span> <span class="op">&#123;</span>
    <span class="at">iconNameCp</span>() <span class="op">&#123;</span>
      <span class="cf">return</span> <span class="vs">`#icon-</span><span class="sc">$&#123;</span><span class="kw">this</span>.<span class="at">iconName</span><span class="sc">&#125;</span><span class="vs">`</span>
    <span class="op">&#125;</span>
  <span class="op">&#125;</span> 
<span class="op">&#125;</span>
<span class="kw">&lt;/script&gt;</span></code></pre></div><p>使用组件的时候可以通过传值 <code>iconName</code> 和 <code>iconColor</code> 确定图标的类型和颜色。</p><h4 id="全局注册组件">全局注册组件</h4><p>因为可能很多地方都会用到图标，这里选择全局注册 <code>SvgIcon.vue</code> 组件。在 <code>src/assets/img/icons</code> 文件夹下新建 <code>index.js</code> 文件：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// 全局引入 svgIcon 组件</span>
<span class="im">import</span> Vue <span class="im">from</span> <span class="st">&#39;vue&#39;</span>
<span class="im">import</span> SvgIcon <span class="im">from</span> <span class="st">&#39;@/components/common/icon/SvgIcon.vue&#39;</span>
<span class="va">Vue</span>.<span class="at">component</span>(<span class="st">&#39;svg-icon&#39;</span><span class="op">,</span> SvgIcon)

<span class="co">// 让 icons/svg下面的图片自动导入，而不是每次手动导入</span>
<span class="kw">const</span> req <span class="op">=</span> <span class="va">require</span>.<span class="at">context</span>(<span class="st">&#39;./svg&#39;</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="ss">/</span><span class="sc">\.</span><span class="ss">svg</span><span class="sc">$</span><span class="ss">/</span>)<span class="op">;</span>
<span class="va">req</span>.<span class="at">keys</span>().<span class="at">map</span>(req)<span class="op">;</span></code></pre></div><p>之后，在 <code>main.js</code> 中引入 <code>index.js</code> 文件：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">import</span> <span class="st">&#39;assets/img/icons&#39;</span></code></pre></div><h4 id="使用组件">使用组件</h4><p>以后每次要使用图标就非常方便了，只需要一行代码即可：</p><div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;svg-icon</span><span class="ot"> class=</span><span class="st">&quot;icon&quot;</span><span class="ot"> :icon-name=</span><span class="st">&quot;xxxxx&quot;</span><span class="ot"> :icon-color=</span><span class="st">&quot;xxxxx&quot;</span><span class="kw">&gt;&lt;/svg-icon&gt;</span></code></pre></div><h4 id="样式修改">样式修改</h4><p>从 iconfont 下载下来的图标文件默认没有内联的 <code>fill</code> 属性，所以可以像上面那样直接为 <code>svg</code> 元素指定 <code>fill</code> 属性，<code>fill</code> 会继承给子元素；如果下载的时候选择了颜色，就会多出来内联的 <code>fill</code> 属性，此时需要显式指定子元素的 <code>fill</code> 继承自父元素（否则继承的权重很低，样式无法被应用）：</p><div class="sourceCode"><pre class="sourceCode css"><code class="sourceCode css">svg path <span class="kw">&#123;</span>
    <span class="kw">fill:</span><span class="dt">inherit</span>
<span class="kw">&#125;</span></code></pre></div><p>为什么这里不能写成下面这样呢？</p><div class="sourceCode"><pre class="sourceCode css"><code class="sourceCode css"><span class="fl">.icon</span> path <span class="kw">&#123;</span>
    <span class="kw">fill:</span><span class="dt">inherit</span>
<span class="kw">&#125;</span></code></pre></div><p>这是因为 <code>svg-&gt;use</code> 里面会生成一个 shadow dom，这个 shadow dom 包含了 <code>svg-&gt;path</code>，它是无法通过 css 选择器拿到的，所以上面这个样式声明不会起效果。</p><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg-2.png"></div><p>当然还可以用 <code>currentColor</code> 修改图标颜色。因为在元素自身没有 <code>color</code> 属性的时候，它的 <code>currentColor</code> 会继承父元素的 <code>color</code> 属性，所以可以给 <code>.icon</code> 设置 <code>color</code>，并指定每一个 <code>path</code> 的 <code>fill</code> 属性都是 <code>currentColor</code> ：</p><div class="sourceCode"><pre class="sourceCode css"><code class="sourceCode css"><span class="fl">.icon</span> <span class="kw">&#123;</span>
   <span class="kw">color:</span><span class="dt">#fff</span>
<span class="kw">&#125;</span>

svg path <span class="kw">&#123;</span>
   <span class="kw">fill:</span>currentColor
<span class="kw">&#125;</span></code></pre></div><h4 id="补充">补充</h4><p>iconfont 本身可以根据添加的图标自动生成 js 代码，之后只需将 js 文件引入项目中即可，这种方式同样可以将 <code>svg</code> 注入到 <code>html</code> 中：</p><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg/%E5%A6%82%E4%BD%95%E5%9C%A8Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8svg-3.png"></div><p>但是这种方式不利于代码的维护，不可能说每一次新增图标都到 iconfont 重新生成一遍代码，再重新引入到项目中，这样太麻烦了。所以才使用了 <code>svg-sprite-loader</code> 插件，这样每次新增图标，只需要下载图标并放到对应文件夹即可。</p></div><div class="post-nav"><div class="post-nav-prev"><a href="/2020/04/30/T-%E8%BF%99%E5%91%A8%E4%B8%80%EF%BC%8C%E6%88%91%E7%9A%84%E6%9C%8B%E5%8F%8B%E6%94%B6%E5%88%B0%E4%BA%86%E4%B8%80%E5%B0%81%E5%8B%92%E7%B4%A2%E9%82%AE%E4%BB%B6/" rel="prev" title="这周一，我的朋友收到了一封勒索邮件"><i class="fa fa-angle-double-left"></i>&nbsp这周一，我的朋友收到了一封勒索邮件</a></div><div class="post-nav-next"><a href="/2020/04/25/OS-Linux%20%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C/" rel="next" title="Linux 系统操作">Linux 系统操作&nbsp<i class="fa fa-angle-double-right"></i></a></div><div class="clear"></div></div></article><div class="post-toc"><div class="toc-top">Contents</div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-text">安装插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE"><span class="toc-text">修改配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6"><span class="toc-text">封装图标组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%B3%A8%E5%86%8C%E7%BB%84%E4%BB%B6"><span class="toc-text">全局注册组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-text">使用组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E4%BF%AE%E6%94%B9"><span class="toc-text">样式修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-text">补充</span></a></li></ol></div><div id="vcomments"></div><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"c9Ume1Givsusy6VyqV87iT2z-gzGzoHsz",appKey:"5F7jhJfENet59xDteaKqobSK",notify:!1,verify:!1,placeholder:"Just talk here......",avatar:"retro",pageSize:10,visitor:!0})</script></section></main><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2021</span> My Blog</p><p class="a">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue">PureBlue</a></p></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script src="/js/jquery.fancybox.js"></script><script src="/js/jquery.fancyboxStart.js"></script><script src="/js/toc.js"></script><script src="/js/jquery.toTop.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script><script src="/js/IndexToTop.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script></body></html><!-- rebuild by neat -->