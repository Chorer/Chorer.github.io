<!-- build time:Sun May 31 2020 20:15:13 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script><script src="/js/prism-line-numbers.min.js"></script><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a href="https://github.com/Chorer/hexo-theme-PureBlue" target="_blank" rel="noopener" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><section class="posts"><article class="post_full"><h1 class="post-title"><div class="post-title-link">hexo 中文文章渲染错误的bug解决</div></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2020-03-17&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp662&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp2 mins&nbsp&nbsp&nbsp</span><div class="post-tags"></div></div><div class="post-content"><a id="more"></a><p>这实际上是在很长一段时间内困扰我的一个 bug，在 <code>hexo s</code> 本地查看 markdown 文章后，会偶发性地出现部分文章渲染错误的情况，如下图：</p><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/hexo%20%E4%B8%AD%E6%96%87%E6%96%87%E7%AB%A0%E6%B8%B2%E6%9F%93%E9%94%99%E8%AF%AF%E7%9A%84bug%E8%A7%A3%E5%86%B3/hexo%20%E4%B8%AD%E6%96%87%E6%96%87%E7%AB%A0%E6%B8%B2%E6%9F%93%E9%94%99%E8%AF%AF%E7%9A%84bug%E8%A7%A3%E5%86%B3.png" alt=""></p><p>就变成这个鬼样子了：文章底部有一定的概率渲染不出文字，而且把底部的 <code>div</code> 都给吞了………</p><p>查看源码后发现是一大堆莫名其妙的乱码，并且这种情况仅在打开本地服务器后查看的中文文章下出现。我一开始以为是自己主题的问题，于是更换了其它主题，发现问题依然存在。很长一段时间内没有在网上找到解决方案，鉴于这个 bug 只在本地服务器下才会出现，所以我也就暂时没管了（尽管很难受）。就这样过了一年………</p><p>结果，今天竟然有意外的发现！我发在 v2ex 的求助帖有人回复了，层主说他也遇到了一样的问题，建议我更新 hexo 的版本。我一想，确实很久没更新了，也许是 hexo 的问题，更新之后说不定可以解决。不过，在我更新完版本，满怀欣喜地查看文章的时候，发现很多文章还是渲染出错。</p><p>这时候我注意到一个问题，就是我使用的热更新插件 <a href="https://github.com/hexojs/hexo-browsersync" target="_blank" rel="noopener">hexo-browsersync</a> 在一些文章下没有热更新的提示，而且这些文章恰好就是渲染错误的文章。于是我来到插件的 issue 下，看有没有新的发现 —— 真的有。就是<a href="https://github.com/hexojs/hexo-browsersync/issues/15" target="_blank" rel="noopener">这篇 issue</a>，大概浏览了一遍，发现大家都有和我一样的问题，不管是环境还是症状，都一模一样（流下了同病相怜的泪水）。</p><p>具体的原因，暂时还没有特别明确的解释，但 issue 里有人说是文件流传输过程中编码出错导致的。正常情况下不使用热更新插件还看不出这个错误，在使用之后就暴露这个问题了。按照帖子底下的做法，最终完美解决，所有的文章都正常显示了。</p><p>总结一下，如果你：</p><ul><li><p>使用了 <a href="https://github.com/hexojs/hexo-browsersync" target="_blank" rel="noopener">hexo-browsersync</a> 插件</p></li><li><p><code>hexo s</code> 后检查文章，发现渲染不正常</p></li></ul><p>可以尝试：</p><ul><li><p>卸载 <a href="https://github.com/hexojs/hexo-browsersync" target="_blank" rel="noopener">hexo-browsersync</a> 插件。貌似新版的 hexo 已经支持热更新了，所以不再需要这个插件了</p></li><li><p>保留插件，在 hexo 根目录的 <code>config.yml</code> 文件中添加配置（黑魔法）：</p></li></ul><pre class="line-numbers language-js"><code class="language-js">server<span class="token punctuation">:</span>
  compress<span class="token punctuation">:</span> <span class="token boolean">true</span> 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>完美解决！</p><p>参考：</p><p><a href="https://github.com/hexojs/hexo-browsersync/issues/15" target="_blank" rel="noopener">https://github.com/hexojs/hexo-browsersync/issues/15</a></p><p><a href="https://github.com/twoyao/beautiful-hexo/issues/6" target="_blank" rel="noopener">https://github.com/twoyao/beautiful-hexo/issues/6</a></p></div><div class="post-nav"><div class="post-nav-prev"><a href="/2020/03/20/CP-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2%EF%BC%9A%E6%96%87%E6%B3%95%E5%92%8C%E8%AF%AD%E8%A8%80/" rel="prev" title="编译原理学习笔记-2：文法和语言"><i class="fa fa-angle-double-left"></i>&nbsp编译原理学习笔记-2：文法和语言</a></div><div class="post-nav-next"><a href="/2020/03/17/OS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2%EF%BC%9A%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%92%8C%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/" rel="next" title="操作系统学习笔记-2：体系结构和运行机制">操作系统学习笔记-2：体系结构和运行机制&nbsp<i class="fa fa-angle-double-right"></i></a></div><div class="clear"></div></div></article><div id="vcomments"></div><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"c9Ume1Givsusy6VyqV87iT2z-gzGzoHsz",appKey:"5F7jhJfENet59xDteaKqobSK",notify:!1,verify:!1,placeholder:"Just talk here......",avatar:"mm",pageSize:10,visitor:!0})</script></section></main><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2020</span> My Blog</p><p class="a">Powered by <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a> | Theme - <a href="https://github.com/Chorer/hexo-theme-PureBlue" target="_blank" rel="noopener">PureBlue</a></p></div></footer><script src="https://code.jquery.com/jquery-3.3.1.min.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script src="/js/jquery.fancybox.js"></script><script src="/js/jquery.fancyboxStart.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script><script src="/js/IndexToTop.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script></body></html><!-- rebuild by neat -->