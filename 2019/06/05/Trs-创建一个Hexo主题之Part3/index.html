<!-- build time:Sun Sep 05 2021 18:44:30 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/prism.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><section class="posts"><article class="post_full"><h1 class="post-title"><div class="post-title-link">「译」创建一个Hexo主题-Part3 :评论、分析和小部件</div></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2019-06-05&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp1.8k&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp7 mins&nbsp&nbsp&nbsp</span><div class="post-tags"><i class="fa fa-tags"></i> <a href="/tags/hexo-theme/">hexo theme</a></div></div><div class="post-content"><blockquote><ul><li>原文地址：<a target="_blank" rel="noopener" href="http://www.codeblocq.com/2016/03/Create-an-Hexo-Theme-Part-3-Comments-Analytics-and-Widgets/">Create an Hexo Theme - Part 3: Comments, Analytics and Widgets</a></li><li>原文作者：Jonathan Klughertz</li><li>译者：Chor <span id="more"></span></li></ul></blockquote><p>在这个系列教程中，你将学习怎么从零开始制作一个 Hexo 主题。 在 <a href="https://chorer.github.io/%2F2019%2F03%2F27%2FTrs-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98%E4%B9%8BPart1%2F">part1</a> 和 <a href="https://chorer.github.io/%2F2019%2F03%2F27%2FTrs-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98%E4%B9%8BPart2%2F">part2</a> 中，我们已经创建了博客的所有页面。在这篇文章中，我们将给博客添加 <a target="_blank" rel="noopener" href="https://disqus.com/">Disqus 评论系统</a>，实现 <a target="_blank" rel="noopener" href="https://www.google.com.sg/analytics/">谷歌分析</a>以及完成侧边栏的小部件。</p><h2 id="其它文章的链接">其它文章的链接：</h2><ul><li><a href="https://chorer.github.io/%2F2019%2F03%2F27%2FTrs-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98%E4%B9%8BPart1%2F">创建一个Hexo主题-Part1:首页</a></li><li><a href="https://chorer.github.io/%2F2019%2F03%2F27%2FTrs-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98%E4%B9%8BPart2%2F">创建一个Hexo主题-Part2:其他页面</a></li><li><a href="https://chorer.github.io/2019/06/05/Trs-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98%E4%B9%8BPart3/">创建一个Hexo主题-Part3:评论、分析和小部件</a></li></ul><h2 id="disqus-评论系统">Disqus 评论系统</h2><p>我已经写了一篇关于<a target="_blank" rel="noopener" href="http://www.codeblocq.com/2015/12/Add-Disqus-comments-in-Hexo/">如何在 Hexo 中使用 Disqus 评论系统</a>的文章。请前往查看以了解更多信息，这里我只简单介绍一下怎么使用：</p><p>第一步是获取 Disqus UID 来测试评论功能，可以利用你的账号在这里获取： <img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/%E3%80%8C%E8%AF%91%E3%80%8D%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAHexo%E4%B8%BB%E9%A2%98-Part3%20%E8%AF%84%E8%AE%BA%E3%80%81%E5%88%86%E6%9E%90%E5%92%8C%E5%B0%8F%E9%83%A8%E4%BB%B6/add-disqus-comments-hexo-unique-name.jpg"> 接下来需要完成三个部分：主题文件的 disqus 配置、评论占位区、Disqus 脚本。事不宜迟，我们开始吧。</p><h3 id="主题配置">主题配置</h3><p>我们希望 Disqus UID 是可以配置的，因此给主题的 <code>config.yml</code> 文件添加一个条目：<pre class="line-numbers language-js" data-language="js"><code class="language-js"># Disqus Comments Shortname
disqus_shortname<span class="token operator">:</span> klugjoTest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><h3 id="评论占位区">评论占位区</h3><p>接下来我们给页面和文章详情页添加评论系统。和之前一样，创建一个局部视图文件 <code>layout/_partial/comments.ejs</code>，之后打开 <code>layout/_partial/article-full.ejs</code> 文件，把它插入到末尾。<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/comments.ejs */</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"blog-post"</span><span class="token operator">></span>
   <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Comments <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">partial</span><span class="token punctuation">(</span><span class="token string">'comments'</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>Disqus 需要 ID 为 <code>disqus_thread</code> 的 div 元素，因此我们这里复制官方文档提供的代码：<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>disqus_thread<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">></span></span>Please enable JavaScript to view the <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//disqus.com/?ref_noscript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>comments powered by Disqus.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>将上面的代码合并到 <code>comments</code> 文件中：<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/comments.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>comments <span class="token operator">&amp;&amp;</span> theme<span class="token punctuation">.</span>disqus_shortname<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"blog-post-comments"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>h3<span class="token operator">></span>Comments<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span>
        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"disqus_thread"</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>noscript<span class="token operator">></span>Please enable JavaScript to view the <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"//disqus.com/?ref_noscript"</span><span class="token operator">></span>comments powered by Disqus<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>noscript<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>首先我们检查是否开启了评论功能和设置了 disqus UID，之后将 Disqus 标记代码放到容器里。 以下是容器的 CSS 样式代码：<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* source/css/blog.css */</span>
<span class="token selector">.blog-post-comments</span> <span class="token punctuation">&#123;</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="disqus-脚本">Disqus 脚本</h3><p>在测试之前，我们还需要添加 Disqus 的脚本，这是一切生效的关键。将它和其他脚本一起放在 <code>layout/_partial/after-footer.ejs</code> 的末尾<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/after-footer.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Disqus Comments <span class="token operator">--</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>theme<span class="token punctuation">.</span>disqus_shortname<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>
        <span class="token keyword">var</span> disqus_shortname <span class="token operator">=</span> <span class="token string">'&lt;%= theme.disqus_shortname %>'</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> dsq <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dsq<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
            dsq<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            dsq<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'//'</span> <span class="token operator">+</span> disqus_shortname <span class="token operator">+</span> <span class="token string">'.disqus.com/&lt;% if (page.comments)&#123; %>embed.js&lt;% &#125; else &#123; %>count.js&lt;% &#125; %>'</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>dsq<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>脚本来自于<a target="_blank" rel="noopener" href="https://help.disqus.com/customer/portal/articles/472097-universal-embed-code">官方文档</a>,并且我们在这里将 Disqus UID 参数化。 接着就可以测试一切是否正常工作了。</p><h2 id="谷歌分析">谷歌分析</h2><p>谷歌分析的实现和 Disqus 差不多，所以这里我只简单提一下。具体步骤可以看我的<a target="_blank" rel="noopener" href="http://www.codeblocq.com/2015/12/Add-Google-Analytics-to-your-hexo-blog/">另一篇博客</a>。</p><h3 id="在主题配置文件中设置-tracking-id">在主题配置文件中设置 tracking ID</h3><p>从你的账号中获取谷歌分析的 tracking ID，之后再配置文件中新增条目。<pre class="line-numbers language-js" data-language="js"><code class="language-js"># Google Analytics Tracking <span class="token constant">ID</span>
google_analytics<span class="token operator">:</span> <span class="token constant">UA</span><span class="token operator">-</span><span class="token number">83746351</span><span class="token operator">-</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><h3 id="创建一个新的局部文件">创建一个新的局部文件</h3><p>创建一个新的局部视图文件 <code>layout/_partial/google-analytic.ejs</code><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/google-analytic.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>theme<span class="token punctuation">.</span>google_analytics<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>script<span class="token operator">></span>
        <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span>s<span class="token punctuation">,</span>o<span class="token punctuation">,</span>g<span class="token punctuation">,</span>r<span class="token punctuation">,</span>a<span class="token punctuation">,</span>m</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">[</span><span class="token string">'GoogleAnalyticsObject'</span><span class="token punctuation">]</span><span class="token operator">=</span>r<span class="token punctuation">;</span>i<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token operator">||</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token punctuation">(</span>i<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">=</span>i<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>q<span class="token operator">||</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>i<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">=</span><span class="token number">1</span><span class="token operator">*</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">,</span>
                m<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>async<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>src<span class="token operator">=</span>g<span class="token punctuation">;</span>m<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>m<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span>document<span class="token punctuation">,</span><span class="token string">'script'</span><span class="token punctuation">,</span><span class="token string">'//www.google-analytics.com/analytics.js'</span><span class="token punctuation">,</span><span class="token string">'ga'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ga</span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">,</span> <span class="token string">'&lt;%= theme.google_analytics %>'</span><span class="token punctuation">,</span> <span class="token string">'auto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ga</span><span class="token punctuation">(</span><span class="token string">'send'</span><span class="token punctuation">,</span> <span class="token string">'pageview'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>这是从<a target="_blank" rel="noopener" href="https://support.google.com/analytics/answer/1008080?hl=en">谷歌分析跟踪代码</a>复制粘贴过来的，其中包括一个参数化的 ID。</p><h3 id="合并到局部文件中">合并到局部文件中</h3><p>我们希望可以在任何页面中获取到跟踪代码，而页面上又没有合适的位置来存放，因此我们选择把它添加到 <code>&lt;head&gt;&lt;/head&gt;</code> 的末尾：<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/head.ejs */</span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"X-UA-Compatible"</span> content<span class="token operator">=</span><span class="token string">"IE=edge"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1"</span><span class="token operator">></span>
    <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Google Analytics <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">partial</span><span class="token punctuation">(</span><span class="token string">'google-analytics'</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>大功告成！</p><h2 id="小部件">小部件</h2><p>此时，<code>sidebar.ejs</code> 文件中的小部件还只是一堆采用硬编码的静态 HTML。我们来修复这个问题。</p><h3 id="配置">配置</h3><p>先从配置开始吧。 我们准备创建两个小部件，一个是“关于”，一个是“标签”。相关配置如果以 JavaScript 对象的形式来书写，大概是下面这样：<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span>
    widgets<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        about<span class="token operator">:</span> <span class="token string">"Here goes the about text"</span><span class="token punctuation">,</span>
        tags<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// Or any additional configuration the widget needs</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>这是它在我们的主题配置文件中转换成 YML 的形式：<pre class="line-numbers language-js" data-language="js"><code class="language-js"># Widgets List
widgets<span class="token operator">:</span>
  about<span class="token operator">:</span> This blog is based off the official bootstrap blog template<span class="token punctuation">.</span> Checkout the corresponding tutorial at <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"http://www.codeblocq.com"</span><span class="token operator">></span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>codeblocq<span class="token punctuation">.</span>com<span class="token operator">&lt;</span><span class="token operator">/</span>a
  tags<span class="token operator">:</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="侧边栏代码">侧边栏代码</h3><p>作为所有小部件的占位区，我们的侧边栏需要遍历配置文件中的所有小部件并将其渲染出来： 侧边栏的 EJS 模板如下：<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/sidebar.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> widget <span class="token keyword">in</span> theme<span class="token punctuation">.</span>widgets<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">partial</span><span class="token punctuation">(</span><span class="token string">'widget/'</span> <span class="token operator">+</span> widget<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="第一个小部件关于">第一个小部件：“关于”</h3><p>新建一个局部文件 <code>layout/_partial/widget/about.ejs</code>，之后在里面创建第一个小部件。 代码是从原先的 bootstrap 模板中复制过来的，文本则来自于配置文件。<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/widget/about.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span><span class="token punctuation">(</span>theme<span class="token punctuation">.</span>widgets<span class="token punctuation">.</span>about<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sidebar-module sidebar-module-inset"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>h4<span class="token operator">></span>About<span class="token operator">&lt;</span><span class="token operator">/</span>h4<span class="token operator">></span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> theme<span class="token punctuation">.</span>widgets<span class="token punctuation">.</span>about <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="第二个小部件标签">第二个小部件：“标签”</h3><p>我们给这个部件做一些略微高级的改动。设置一个段落用于存放博客中用过的所有标签。它们互相之间用空格隔开，并且字体大小与标签使用次数成比例。 这是 <code>layout/_partial/widget/tags.ejs</code> 的代码：<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* layout/_partial/widget/tags.ejs */</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>theme<span class="token punctuation">.</span>widgets<span class="token punctuation">.</span>tags <span class="token operator">&amp;&amp;</span> site<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sidebar-module"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>h4<span class="token operator">></span>Tags<span class="token operator">&lt;</span><span class="token operator">/</span>h4<span class="token operator">></span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> site<span class="token punctuation">.</span>tags<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token operator">%</span><span class="token operator">></span>
                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"&lt;%- config.root %>&lt;%- item.path %>"</span> style<span class="token operator">=</span><span class="token string">"font-size: &lt;%- Math.min(item.posts.length * 2 + 13, 30) %>px"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%=</span> item<span class="token punctuation">.</span>name <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">&#125;</span> <span class="token operator">%</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>* <code>site.tags</code> 让我们可以获取所有标签 * <code>site.tags.sort('name)</code> 按照字母表的顺序对所有标签进行排序 * <code>item.path</code> 对应标签归档页的相对 URL * <code>item.posts.length</code> 表示标签的使用次数 * <code>item.name</code> 是标签的名字</p><p>我这里选择 <code>13+（标签使用次数 *2）px</code> 作为字体大小的计算方式，并且最大不超过 <code>30px</code>。当然，你可以根据自己的喜好来。</p><h2 id="最后">最后</h2><p>教程到这里就结束了，我希望你从中可以学到不少有趣的东西。 如果你想进一步打磨主题，可以考虑下面这些事情： * 通过参数化 <code>&lt;title&gt;</code> 和所有 <a target="_blank" rel="noopener" href="http://ogp.me/">Open Graph</a> 属性完善 <code>head</code> 部分 * 添加更多小部件，例如<a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-theme-light/blob/master/layout/_widget/search.ejs">搜索小部件</a> 或者是一个 <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-theme-light/blob/master/layout/_widget/recent_posts.ejs">近期文章小部件</a> * 将你的主题提交到 <a target="_blank" rel="noopener" href="https://hexo.io/themes/">Hexo官方主题站点</a> * 查看我的其他 <a target="_blank" rel="noopener" href="http://www.codeblocq.com/tags/">Hexo 教程</a>来改进你的博客 * 查看<a target="_blank" rel="noopener" href="https://github.com/cgmartin/hexo-theme-bootstrap-blog">hexo-theme-bootstrap-blog</a>,这个主题同样是基于 bootstrap 模板实现的 * 从零开始打造你自己的主题</p><p>感谢阅读！欢迎在评论区留下你的评论、指正和意见。</p></div><div class="post-nav"><div class="post-nav-prev"><a href="/2019/06/06/F-CSS%20%E5%9F%BA%E7%A1%80%E7%B3%BB%E5%88%97%EF%BC%9Aflex%20%E5%B8%83%E5%B1%80/" rel="prev" title="CSS 基础系列：flex 布局"><i class="fa fa-angle-double-left"></i>&nbspCSS 基础系列：flex 布局</a></div><div class="post-nav-next"><a href="/2019/05/31/F-CSS%20%E5%9F%BA%E7%A1%80%E7%B3%BB%E5%88%97%EF%BC%9A%E5%B8%B8%E8%A7%81%E5%B8%83%E5%B1%80%E6%96%B9%E5%BC%8F/" rel="next" title="CSS 基础系列：常见布局方式">CSS 基础系列：常见布局方式&nbsp<i class="fa fa-angle-double-right"></i></a></div><div class="clear"></div></div></article><div class="post-toc"><div class="toc-top">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0%E7%9A%84%E9%93%BE%E6%8E%A5"><span class="toc-text">其它文章的链接：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#disqus-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F"><span class="toc-text">Disqus 评论系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE"><span class="toc-text">主题配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E8%AE%BA%E5%8D%A0%E4%BD%8D%E5%8C%BA"><span class="toc-text">评论占位区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#disqus-%E8%84%9A%E6%9C%AC"><span class="toc-text">Disqus 脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%B7%E6%AD%8C%E5%88%86%E6%9E%90"><span class="toc-text">谷歌分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AE%BE%E7%BD%AE-tracking-id"><span class="toc-text">在主题配置文件中设置 tracking ID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%B1%80%E9%83%A8%E6%96%87%E4%BB%B6"><span class="toc-text">创建一个新的局部文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%88%B0%E5%B1%80%E9%83%A8%E6%96%87%E4%BB%B6%E4%B8%AD"><span class="toc-text">合并到局部文件中</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E9%83%A8%E4%BB%B6"><span class="toc-text">小部件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%A7%E8%BE%B9%E6%A0%8F%E4%BB%A3%E7%A0%81"><span class="toc-text">侧边栏代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%B0%8F%E9%83%A8%E4%BB%B6%E5%85%B3%E4%BA%8E"><span class="toc-text">第一个小部件：“关于”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%B0%8F%E9%83%A8%E4%BB%B6%E6%A0%87%E7%AD%BE"><span class="toc-text">第二个小部件：“标签”</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-text">最后</span></a></li></ol></div><div id="vcomments"></div><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"c9Ume1Givsusy6VyqV87iT2z-gzGzoHsz",appKey:"5F7jhJfENet59xDteaKqobSK",notify:!1,verify:!1,placeholder:"Just talk here......",avatar:"retro",pageSize:10,visitor:!0})</script></section></main><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2021</span> My Blog</p><p class="a">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue">PureBlue</a></p></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script src="/js/jquery.fancybox.js"></script><script src="/js/jquery.fancyboxStart.js"></script><script src="/js/toc.js"></script><script src="/js/jquery.toTop.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script><script src="/js/IndexToTop.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script></body></html><!-- rebuild by neat -->