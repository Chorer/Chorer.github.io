<!-- build time:Sun Sep 05 2021 14:32:58 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><div class="tag-page-container"><div class="tag-page-title"><span class="tag_title">浏览器渲染</span></div><div class="tag-page-cards"><section class="posts"><article class="post_full post_except"><h1 class="post-title"><a class="post-title-link" href="/2019/02/18/F-jQuery AJAX load()方法中代码执行顺序的问题/">jQuery AJAX load()方法中代码执行顺序的问题</a></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2019-02-18&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp729&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp2 mins&nbsp&nbsp&nbsp</span></div><div class="post-content"><a href="/2019/02/18/F-jQuery AJAX load()方法中代码执行顺序的问题/"><span id="more"></span><p>问题来源于菜鸟教程介绍 jQuery <code>load()</code> 方法时用的一个实例：</p><p><strong>JS：</strong></p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="at">$</span>(<span class="st">&quot;button&quot;</span>).<span class="at">click</span>(<span class="kw">function</span>()<span class="op">&#123;</span>
  <span class="at">$</span>(<span class="st">&quot;#div1&quot;</span>).<span class="at">load</span>(<span class="st">&quot;demo_test.txt&quot;</span><span class="op">,</span><span class="kw">function</span>(responseTxt<span class="op">,</span>statusTxt<span class="op">,</span>xhr)<span class="op">&#123;</span>
    <span class="cf">if</span>(statusTxt<span class="op">==</span><span class="st">&quot;success&quot;</span>)
      <span class="at">alert</span>(<span class="st">&quot;外部内容加载成功!&quot;</span>)<span class="op">;</span>
    <span class="cf">if</span>(statusTxt<span class="op">==</span><span class="st">&quot;error&quot;</span>)
      <span class="at">alert</span>(<span class="st">&quot;Error: &quot;</span><span class="op">+</span><span class="va">xhr</span>.<span class="at">status</span><span class="op">+</span><span class="st">&quot;: &quot;</span><span class="op">+</span><span class="va">xhr</span>.<span class="at">statusText</span>)<span class="op">;</span>
  <span class="op">&#125;</span>)<span class="op">;</span>
<span class="op">&#125;</span>)<span class="op">;</span></code></pre></div><p><strong>HTML：</strong></p><div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;div1&quot;</span><span class="kw">&gt;&lt;h2&gt;</span>使用 jQuery AJAX 修改该文本<span class="kw">&lt;/h2&gt;&lt;/div&gt;</span>
<span class="kw">&lt;button&gt;</span>获取外部内容<span class="kw">&lt;/button&gt;</span></code></pre></div><p>这里作为load方法参数的函数是一个回调函数。什么是回调函数呢？我们先来看看回调的英文定义：</p><blockquote><p>A callback is a function that is passed as an argument to another function and is executed after its parent function has completed。</p></blockquote><p>字面上的理解，回调函数就是一个参数，将这个函数作为参数传到另一个函数里面，当那个函数执行完之后，再执行传进去的这个函数。这个过程就叫做回调。那么根据这个解释，这段代码应该是先执行 <code>load(&quot;demo_test.txt&quot;)</code> 加载外部内容，之后再执行回调函数弹出 alert。但是实际运行后发现和预想的不一样：</p><p><img src="https://raw.githubusercontent.com/Chorer/MyBlog-Pic/master/Myblogs/jQuery%20AJAX%20load()方法中代码执行顺序的问题-1.png"> <img src="https://raw.githubusercontent.com/Chorer/MyBlog-Pic/master/Myblogs/jQuery%20AJAX%20load()方法中代码执行顺序的问题-2.png"></p><p>从结果来看，是先弹出 alert 再改变文本内容。那么，为什么会这样呢？难道上面的说法有误？为了进一步验证，修改代码如下：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="at">$</span>(<span class="st">&quot;#div1&quot;</span>).<span class="at">load</span>(<span class="st">&quot;demo_test.txt&quot;</span><span class="op">,</span><span class="kw">function</span>(responseTxt<span class="op">,</span>statusTxt<span class="op">,</span>xhr)<span class="op">&#123;</span>
<span class="at">alert</span>(responseTxt)<span class="op">;</span>
<span class="cf">if</span>(statusTxt<span class="op">==</span><span class="st">&quot;success&quot;</span>)<span class="op">&#123;</span></code></pre></div><p>运行：</p><p><img src="https://raw.githubusercontent.com/Chorer/MyBlog-Pic/master/Myblogs/jQuery%20AJAX%20load()方法中代码执行顺序的问题-3.png"> 很明显文本内容已经改变，说明前面关于回调函数最后执行的说法是没问题的。接着猜想，之所以先弹出 alert 再改变文本内容，可能是因为必须等回调函数执行完后才能把文本渲染到浏览器上。 为了进一步验证，修改代码如下：</p><div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="at">$</span>(<span class="st">&quot;#div1&quot;</span>).<span class="at">load</span>(<span class="st">&quot;demo_test.txt&quot;</span><span class="op">,</span><span class="kw">function</span>(responseTxt<span class="op">,</span>statusTxt<span class="op">,</span>xhr)<span class="op">&#123;</span>
    <span class="cf">if</span>(statusTxt<span class="op">==</span><span class="st">&quot;success&quot;</span>)<span class="op">&#123;</span>
        debugger；
        <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;1&quot;</span>)<span class="op">;</span>
      <span class="op">&#125;</span></code></pre></div><p>运行：</p><p><img src="https://raw.githubusercontent.com/Chorer/MyBlog-Pic/master/Myblogs/jQuery%20AJAX%20load()方法中代码执行顺序的问题-4.png"> 控制台中没有打印出1，且程序中断，说明此时回调函数还在执行当中，但是文本内容却已经改变了。这说明上面的猜想错误-----即文本渲染到浏览器上不需要等到回调函数执行结束。 但是，那只是一般情况！！问题就在于，<strong>alert是可以阻塞浏览器的渲染工作的！</strong></p><p>重新运行最初的代码，可以看到还是先弹出 alert，文本没变，但是这时候点开控制台的 elements，可以看到图中红框显示这时候文本的内容其实已经改变了。</p><p><img src="https://raw.githubusercontent.com/Chorer/MyBlog-Pic/master/Myblogs/jQuery%20AJAX%20load()方法中代码执行顺序的问题-5.png"> 虽然文本内容看上去不变------但是实际情况是文本内容已经改变了，也就是 <code>load()</code> 方法已经生效了，只是 alert 阻塞了浏览器将它渲染出来。 在这里还要注意，alert 可以阻塞浏览器的渲染，而 debugger 是没办法的。</p><div class="default">阅读全文......</div></a></div><div class="post-sub_container"><span class="post-tags"><i class="fa fa-tags"></i> <a href="/tags/AJAX/">AJAX</a> <a href="/tags/浏览器渲染/">浏览器渲染</a></span></div></article></section></div></div></main><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2021</span> My Blog</p><p class="a">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue">PureBlue</a></p></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script></body></html><!-- rebuild by neat -->