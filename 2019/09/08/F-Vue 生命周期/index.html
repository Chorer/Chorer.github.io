<!-- build time:Sun Sep 05 2021 16:01:26 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=0" name="viewport"><title>Focus on FE learning</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/third%20party/jquery.fancybox.css"><link rel="stylesheet" href="/css/third%20party/pace-theme-flash.css"><link rel="icon" href="/images/kour.gif"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head><body><header class="header"><div class="header_top"><span class="theme"><a href="/">Chor's blog</a></span><nav class="navbar"><ul class="menu"><li class="menu-item"><i class="fa fa-home"></i> <a href="/" class="menu-item-link">首页</a></li><li class="menu-item"><i class="fa fa-folder-open"></i> <a href="/categories" class="menu-item-link">分类</a></li><li class="menu-item"><i class="fa fa-archive"></i> <a href="/archives" class="menu-item-link">归档</a></li><li class="menu-item"><i class="fa fa-tags"></i> <a href="/tags" class="menu-item-link">标签</a></li><li class="menu-item"><i class="fa fa-user"></i> <a href="/about" class="menu-item-link">关于</a></li></ul></nav></div><i id="homelink" data-link="https://chorer.github.io/"></i><div class="header_bottom"><div class="blog-title"><a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue" class="logo">Focus on FE learning</a><div class="descrs"><div class="descr">个人博客</div><div class="descr">" Do what you love,Love what you do "</div></div><div class="blog-down"><a href="javascript:void(0);"><i class="fa fa-angle-double-down fa-2x"></i></a></div></div></div></header><main class="main"><section class="posts"><article class="post_full"><h1 class="post-title"><div class="post-title-link">Vue 生命周期与钩子函数</div></h1><div class="post-info"><div class="post-date"><i class="fa fa-calendar"></i>&nbsp2019-09-08&nbsp&nbsp&nbsp</div><span class="post-words"><i class="fa fa-pencil-square-o"></i>&nbsp1.8k&nbspwords&nbsp&nbsp </span><span class="post-time"><i class="fa fa-clock-o"></i>&nbsp8 mins&nbsp&nbsp&nbsp</span><div class="post-tags"><i class="fa fa-tags"></i> <a href="/tags/Vue/">Vue</a></div></div><div class="post-content"><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-1.jpg"> <span id="more"></span></p><h2 id="vue-生命周期">1.Vue 生命周期</h2><blockquote><p>Vue 实例从创建到销毁的过程，就是生命周期。也就是从开始创建、初始化数据、编译模板、挂载 dom→渲染、更新→渲染、卸载等一系列过程，我们称这是 Vue 的生命周期。</p></blockquote><h2 id="vue-生命周期函数">2.Vue 生命周期函数</h2><p>Vue 的生命周期共有 8 个阶段，即<strong>创建前/后、载入前/后、更新前/后、销毁前/销毁后</strong>，并对应地有很多钩子函数，让我们在控制整个Vue实例的过程时更容易形成好的逻辑。</p><h2 id="vue-生命周期图">3.Vue 生命周期图</h2><p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/guide/instance.html">Vue 官网图片</a>： <img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-2.png"></p><h2 id="vue-生命周期进程">4. Vue 生命周期进程</h2><p>根据上面的图来分析 Vue 生命周期的进程：</p><p><strong>1. 实例化 Vue（组件）对象，确定 this 指向 Vue 实例</strong></p><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-3.png"></div><p><strong>2. 初始化事件（events）和生命周期（cycle）</strong></p><div class="figure"><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-4.png"></div><p><strong>3. <code>beforeCreate</code> 函数</strong></p><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-5.png"> 这一阶段，虽然 Vue 对象已经创建，但是它的属性还没有绑定，诸如 data、computed 这些属性还没有赋值。所以 <code>$el</code>，<code>$data</code> 以及 <code>message</code> 都是 undefined。</p><p><strong>4. 初始化注入和响应</strong></p><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-6.png"> 这一阶段，Vue 对象的属性注入绑定，完成属性赋值。</p><p><strong>5. <code>Created</code> 函数</strong></p><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-7.png"> 这一阶段可以访问数据，但是还没有挂载 dom，不能访问到 <code>$el</code>。因为这个原因，此时改变数据不会触发 updated 函数。</p><p><strong>6. 两次判断</strong></p><p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-8.png"> 这个阶段会进行两次判断： * 判断对象是否有 el 选项 如果有则继续向下编译；如果没有则停止编译，也即停止生命周期，直到在实例上再次调用 <code>vm.$mount(el)</code> 才会继续向下编译 * 判断 el 是否有 template 模板 如果有则将该模板编译为渲染函数，最后渲染出来；如果没有则直接调用 $el 的 <strong>outerHTML</strong> 进行渲染。另外，如果 Vue 对象中有渲染函数（render function），则它会优先于 template 进行渲染。 综上，优先级是：render function &gt; template &gt; outerHTML</p><p><strong>7. <code>beforeMount</code> 函数</strong></p><img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-9.png"> 这个阶段，this.<span class="math inline">\(el 有值，但是数据还没有挂载到页面上，`{{}}` 还没有被替换 **8. 用 vue 对象的数据（属性）替换模板中的内容** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-10.png) **9. `mounted` 函数** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-11.png) 模板编译完成，数据挂载完毕，页面上已经能够看到正确的数据了。 **10. `beforeUpdate` 函数** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-12.png) 数据更新后首先触发该函数，但更新的只是数据，innerHTML 尚未更新 **11. 虚拟 dom 重新渲染并打补丁** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-13.png) **12. `updated` 函数** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-14.png) 这一阶段，innerHTML 已经得到更新。 PS：这里解释一个问题。在 beforeUpdate 函数中访问 `this.$el`，`innerHTML` 时得到的是旧数据，这是正常的；但访问 `this.$el` 的时候，得到的却是新数据，这是因为： 1. console.log 是异步的，我们期望打印的时候是打印那一刻的快照，但实际上它不能做到这一点，所以在后面点击展开 `this.$el` 的内容时，实际上只能访问到最新更新的对象； 2. `this.$el` 保存的是对象的引用。 **13. `beforeDestroy` 函数** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-15.png) 这一阶段，实例还没有销毁，仍然完全可用 **14. 销毁实例** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-16.png) **14. `destroyed` 函数** ![](https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-17.png) 实例销毁之后调用该函数，使 Vue 实例指示的所有东西解绑定，所有的监听器被移除，所有的子实例销毁。 ## 5.通过控制台观察生命周期的过程 ```vue<!DOCTYPE html><html><head><title></title><script type="text/javascript" src="https://cdn.jsdelivr.net/vue/2.1.3/vue.js"></script></head><body><div id="app"><p>&lt;/p&gt; &lt;/div&gt; &lt;script type=&quot;text/javascript&quot;&gt; var app = new Vue({ el: &#39;#app&#39;， data: { message : &quot;Vue&quot; }， beforeCreate: function () { console.group(&#39;beforeCreate 创建前状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot; ， &quot;el : &quot; + this.\)</p></div></body></html></span>el); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.<span class="math inline">\(data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， created: function () { console.group(&#39;created 创建完毕状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot; + this.\)</span>el); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.<span class="math inline">\(data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， beforeMount: function () { console.group(&#39;beforeMount 挂载前状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot;); console.log(this.\)</span>el);<br>console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.<span class="math inline">\(data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， mounted: function () { console.group(&#39;mounted 挂载结束状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot;); console.log(this.\)</span>el);<br>console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.<span class="math inline">\(data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， beforeUpdate: function () { console.group(&#39;beforeUpdate 更新前状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot;); console.log(this.\)</span>el);<br>console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el.outerHTML : &quot; + this.<span class="math inline">\(el.outerHTML); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.\)</span>data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， updated: function () { console.group('updated 更新完成状态===============》'); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot;); console.log(this.<span class="math inline">\(el); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el.outerHTML : &quot; + this.\)</span>el.outerHTML); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.<span class="math inline">\(data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， beforeDestroy: function () { console.group(&#39;beforeDestroy 销毁前状态===============》&#39;); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot; + this.\)</span>el); console.log(this.<span class="math inline">\(el); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.\)</span>data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); }， destroyed: function () { console.group('destroyed 销毁完成状态===============》'); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;el : &quot; + this.<span class="math inline">\(el); console.log(this.\)</span>el);<br>console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;data : &quot; + this.$data); console.log(&quot;%c%s&quot;， &quot;color:red&quot;，&quot;message: &quot; + this.message); } });</div></article></section></main></body></html><p>```</p><p>第一次渲染，可以在控制台看到： <img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-18.png"></p><p>之后手动修改 message 的值为“Vue2”，可以在控制台看到： <img src="https://myblog-1258623898.cos.ap-chengdu.myqcloud.com/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0-19.png"></p><p>这里注意之前提到的 log 异步的问题，看 outerHTML 可以知道 beforeUpdate 的时候视图实际上还没有重新渲染。</p><div class="post-nav"><div class="post-nav-prev"><a href="/2019/09/10/CB-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0cp1/" rel="prev" title="数据结构与算法笔记cp1：基本概念"><i class="fa fa-angle-double-left"></i>&nbsp数据结构与算法笔记cp1：基本概念</a></div><div class="post-nav-next"><a href="/2019/08/06/F-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD/" rel="next" title="数据类型判断">数据类型判断&nbsp<i class="fa fa-angle-double-right"></i></a></div><div class="clear"></div></div><div class="post-toc"><div class="toc-top">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">1.Vue 生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">2.Vue 生命周期函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%BE"><span class="toc-text">3.Vue 生命周期图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%BF%9B%E7%A8%8B"><span class="toc-text">4. Vue 生命周期进程</span></a></li></ol></div><div id="vcomments"></div><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"c9Ume1Givsusy6VyqV87iT2z-gzGzoHsz",appKey:"5F7jhJfENet59xDteaKqobSK",notify:!1,verify:!1,placeholder:"Just talk here......",avatar:"retro",pageSize:10,visitor:!0})</script><script>var user=[1,2,3,4]</script><footer class="footer"><div class="footer-info"><p>Copyright © 2018 - <span>2021</span> My Blog</p><p class="a">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a target="_blank" rel="noopener" href="https://github.com/Chorer/hexo-theme-PureBlue">PureBlue</a></p></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script><script src="/js/navbar.js"></script><script src="/js/pace.min.js"></script><script src="/js/code.js"></script><script src="/js/load.js"></script><script src="/js/search.js"></script><script src="/js/post-except.js"></script><script src="/js/jquery.fancybox.js"></script><script src="/js/jquery.fancyboxStart.js"></script><script src="/js/toc.js"></script><script src="/js/jquery.toTop.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script><script src="/js/IndexToTop.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8f8959eacf92e"></script><!-- rebuild by neat -->